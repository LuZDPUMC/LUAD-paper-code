# LUAD-paper-code
Multi-omics data-based modeling reveals tumorigenesis- and prognosis-associated genes with clinical potential in lung adenocarcinoma

# GTEX+TCGA_data_analysis.R
This comprehensive R script pipeline is designed to analyze gene expression differences between normal and tumor tissues (LUAD) using integrated GTEx and TCGA data. The workflow consists of four major steps: (1) Data arrangement: The expression matrix was preprocessed by removing genes with low expression (expressed in less than 50% of samples), imputing missing values using the K-nearest neighbors (KNN) algorithm, and averaging duplicated genes. The data were then log2-transformed to reduce variance and approximate normality, and a curated list of genes of interest was used to extract a refined expression matrix for downstream analysis. (2) Differential expression analysis: Differential expression between normal tissues (n = 347) and tumor tissues (n = 515) was assessed using the Wilcoxon rank-sum test. For each gene, the mean expression, log fold change (logFC), p-value, and median difference were calculated. False discovery rate (FDR) correction was applied to control for multiple testing. Genes with an absolute logFC > 1 and FDR < 0.05 were considered significantly differentially expressed. The complete results were saved as all.xls, and the list of significant differentially expressed genes (DEGs) was saved as diff.xls. A matrix containing expression values of significant DEGs (diffGeneExp.txt) was prepared for visualization. (3) Heatmap visualization: A ranked transformation was applied to the expression matrix of significant DEGs to normalize value distribution before visualization. The pheatmap package was used to generate a heatmap with sample type annotations (normal vs tumor), and the final heatmap was saved as a PDF file. (4) Volcano plot visualization: The DEG data were further visualized using a volcano plot to highlight significantly upregulated and downregulated genes. Genes were categorized as "Up", "Down", or "Not" based on logFC and FDR thresholds. The plot was created using ggplot2 and exported as a PDF.



# TCGA_ATAC_LUAD_data_analysis.R
This comprehensive R code pipeline is designed to systematically analyze TCGA-LUAD (lung adenocarcinoma) ATAC-seq data, covering steps from data preparation to differential peak annotation. First, it processes and normalizes the ATAC-seq expression matrix, extracts peak coordinates, and constructs a peak matrix for downstream analyses. Then, using genome visualization tools (karyoploteR), it generates global genomic coverage plots. Next, it performs functional annotation of peaks and visualizes the distribution using pie charts, bar charts, upset plots, TSS distance plots, heatmaps, and average profile curves. Functional enrichment analyses (GO and KEGG) are conducted on peak-associated genes to explore biological processes and signaling pathways. Finally, the pipeline identifies differentially accessible peaks (diff peaks) between sample groups, annotates them in detail, and saves the results. Overall, this workflow provides a complete framework for exploring chromatin accessibility patterns, functional enrichment, and potential clinical implications in ATAC-seq data from lung adenocarcinoma.


# TCGA_DEGs_Diffpeekgenes.R
This code performs two main steps. First, it identifies the intersection of differentially expressed genes (DEGs) from RNA-seq and differential peak-associated genes from ATAC-seq using a Venn diagram. This intersection represents genes that are both transcriptionally and epigenetically altered. Second, the code extracts RNA-seq expression data for these intersected genes from a DEG expression matrix. The final expression matrix (veengenexpr.txt) is prepared for use in downstream diagnostic model construction such as SVM, RF, or ANN.


# LUAD_Predictive Model_code.R
This code implements a comprehensive workflow for gene feature selection, model construction, prediction, and validation using multiple machine learning methods. First, it applies Random Forest to select important genes from input gene expression data and visualizes their importance. Then, it uses LASSO regression for feature gene selection and cross-validation to identify the optimal regularization parameter, outputting key genes and their expression profiles. Next, it calculates gene scores based on differential expression to build sample features, and trains an Artificial Neural Network (ANN) model for sample classification, evaluating accuracy and visualizing the model on the training set. Finally, it performs gene scoring and ANN prediction on an independent test dataset, and evaluates the model's predictive performance on the test set via ROC curve analysis, reporting the AUC and confidence intervals. This pipeline integrates multiple machine learning techniques to achieve end-to-end gene selection and model validation.

# LUAD_Prognostic Model_code.R
The provided code performs a comprehensive survival analysis workflow using gene expression and clinical data. It begins by identifying significantly differentially expressed genes between normal and tumor samples through Wilcoxon tests and visualizes their expression in a heatmap. Next, it conducts Kaplan-Meier survival analysis to compare survival outcomes between high- and low-risk patient groups, followed by calibration curve plotting to evaluate the predictive accuracy of Cox proportional hazards models at multiple time points. The code also generates risk score plots, survival status scatterplots, and heatmaps to visualize patient risk stratification and gene expression patterns. Independent prognostic analyses are performed using univariate and multivariate Cox regression to identify significant clinical and molecular predictors, with results presented as forest plots. Finally, a nomogram is constructed integrating risk scores and clinical variables to predict individual patient survival probabilities, accompanied by calibration curves and concordance index assessment to validate model performance.



